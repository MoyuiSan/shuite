import{c as E,o as h,a as f,w as k,v as $,b as r,p as S,d as A,e as v,r as p,f as i,g as m,h as b,F as V,n as C,i as j,T as U,j as x,k as B,K as z,l as H,m as Y,q as K,t as L,s as Q,u as W,x as Z,z as J,B as X,C as G,H as ee,S as te,N as oe,y as se,Q as ne,U as ae,A as ie,L as re,E as le,D as ce,G as de,I as ue,J as me,M as _e,V as he,O as pe,P as fe,R as ge,W as ve,X as ye,Y as be,Z as Ie,_ as Ee,$ as we,a0 as Se,a1 as Ae,a2 as Le}from"./vendor.dd298bfa.js";const Te=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&l(a)}).observe(document,{childList:!0,subtree:!0});function c(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(o){if(o.ep)return;o.ep=!0;const s=c(o);fetch(o.href,s)}};Te();var I=(e,t)=>{for(const[c,l]of t)e[c]=l;return e};AV;const Pe={name:"Login",data(){return{cloud:E.init({env:"yui-7gel1hqtaf6fb79d"}),email:"",password:"",test:""}},computed:{test(){return this.$store.state.islogin}},created(){AV.init({appId:"tYNddUiQgK4ghsF9PDzRiz2j-MdYXbMMI",appKey:"I3DfpmsVmqqeA66CARr0H1Br"})},mounted(){const e=new AV.Query("userinfo");e.equalTo("email",this.email),e.find().then(t=>{console.log(t)})},methods:{register(){NProgress.start();const e=this.email;/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(e)?this.cloud.auth().signUpWithEmailAndPassword(this.email,this.password).then(()=>{NProgress.done()}).catch(c=>{c&&this.$ElMessage.error("\u90AE\u7BB1\u5DF2\u5B58\u5728\uFF01"),NProgress.done()}):(alert("\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E"),NProgress.done())},login(){NProgress.start(),this.cloud.auth({persistence:"local"}).signInWithEmailAndPassword(this.email,this.password).then(t=>{localStorage.setItem("yui_login_user",this.email);const c=new AV.Query("userinfo");c.equalTo("email",this.email);const l=this.cloud.database();l.command;const s=this.cloud.auth({persistence:"local"}).currentUser;l.collection("user").where({email:this.email}).get().then(a=>{if(!!a.data[0]||localStorage.getItem("uesr_auth")=="normal")return!1;l.collection("user").add({email:this.email,uauth:"1",created:Date.now(),updated:Date.now(),isEffect:"1",uid:s.uid}).then(d=>{console.log(d)})}),l.collection("user").where({email:localStorage.getItem("yui_login_user")}).get().then(a=>{const d=a.data;a.data&&(d[0].isEffect==="1"&&d[0].uauth==="0"?localStorage.setItem("user_auth","admin"):localStorage.setItem("user_auth","normal"))}),c.find().then(a=>{if(!a){const _=AV.Object.extend("userinfo"),y=new _;y.set("nickname","\u65E0\u540D\u4EBA\u58EB"),y.set("email",this.email),y.save().then(g=>{console.log(`\u4FDD\u5B58\u6210\u529F\u3002objectId\uFF1A${g.id}`)},g=>{ElMessage.error("\u6570\u636E\u4FDD\u5B58\u5931\u8D25!")})}let d=setTimeout(()=>{this.$store.commit("increment"),NProgress.done(),window.location.reload(),clearTimeout(d)},500);d=null})});let e=setTimeout(()=>{localStorage.getItem("yui_login_user")||ElMessage.error("\u8D26\u6237\u5BC6\u7801\u9519\u8BEF!"),NProgress.done(),clearTimeout(e)},2e3);e=null}}},M=e=>(S("data-v-d4f45df8"),e=e(),A(),e),ke={class:"login boxshadow"},$e=M(()=>r("h2",null,"\u767B\u5F55",-1)),Ve={class:"register"},Ce=v("\u6CA1\u6709\u8D26\u53F7?"),xe={class:"btn"},Me=M(()=>r("button",null,"\u91CD\u7F6E",-1));function De(e,t,c,l,o,s){return h(),f("div",ke,[$e,k(r("input",{type:"email",placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u90AE\u7BB1","onUpdate:modelValue":t[0]||(t[0]=a=>o.email=a)},null,512),[[$,o.email]]),k(r("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=a=>o.password=a),placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u5BC6\u7801"},null,512),[[$,o.password]]),r("div",Ve,[Ce,r("span",{onClick:t[2]||(t[2]=(...a)=>s.register&&s.register(...a))},"\u6CE8\u518C\u4E00\u4E0B")]),r("div",xe,[r("button",{onClick:t[3]||(t[3]=(...a)=>s.login&&s.login(...a))},"\u767B\u9646"),Me])])}var Oe=I(Pe,[["render",De],["__scopeId","data-v-d4f45df8"]]);const qe={data(){return{userAuth:localStorage.getItem("user_auth")=="admin",islogin:!1,cloud:cloudbase.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,user:localStorage.getItem("yui_login_user")}},computed:{},created(){this.auth=this.cloud.auth({persistence:"local"}),console.log(localStorage.getItem("user_auth")),localStorage.getItem("access_token_yui-7gel1hqtaf6fb79d")?JSON.parse(localStorage.getItem("login_type_yui-7gel1hqtaf6fb79d")).content==="ANONYMOUS"?console.log("\u533F\u540D\u767B\u5F55\u4E2D"):this.islogin=!0:this.islogin=!1},methods:{exit(){localStorage.removeItem("login_type_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("user_info_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("refresh_token_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("yui_login_user"),localStorage.removeItem("access_token_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("access_token_expire_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("user_auth"),localStorage.removeItem("anonymous_uuid_yui-7gel1hqtaf6fb79d"),window.location.reload()},goLogin(){this.$store.commit("increment")}},components:{}},T=e=>(S("data-v-3b0d21f8"),e=e(),A(),e),Ne={class:"h-normal boxshadow"},Re={class:"header-left"},Fe={class:"header-left-item"},je=v("\u9996\u9875 "),Ue={class:"header-left-item header-left-noshow"},Be=v("\u5410\u69FD "),ze={class:"header-left-item"},He=v("\u8FFD\u756A "),Ye={class:"header-left-item header-left-noshow"},Ke=v("\u65E5\u8BED "),Qe={class:"header-left-item header-left-noshow"},We=v("\u77E5\u8BC6\u5E93 "),Ze={class:"header-left-item"},Je=v("\u5173\u4E8E "),Xe={key:0,class:"header-right"},Ge={class:"header-right-item header-right-menu"},et={class:"user-menu"},tt=T(()=>r("div",{class:"user-menu-item"},"\u6211\u7684\u4FE1\u606F",-1)),ot={key:0,class:"line"},st={key:0,class:"user-menu-item"},nt=T(()=>r("div",{class:"line"},null,-1)),at=T(()=>r("div",{class:"user-menu-item"},"\u9000\u51FA\u767B\u5F55",-1)),it=[at],rt={class:"header-right-item"},lt=v("\u7BA1\u7406"),ct={key:1,class:"header-right"},dt={class:"header-right-item"},ut={class:"header-right-item header-right-menu"},mt=v(" \u767B\u5F55 "),_t={class:"user-menu"};function ht(e,t,c,l,o,s){const a=p("house"),d=p("el-icon"),_=p("router-link"),y=p("baseball"),g=p("calendar"),N=p("school"),R=p("milkTea"),F=p("question-filled"),P=p("el-avatar");return h(),f("header",Ne,[r("div",Re,[i(_,{to:"/"},{default:m(()=>[r("div",Fe,[i(d,null,{default:m(()=>[i(a)]),_:1}),je])]),_:1}),i(_,{to:"/chat"},{default:m(()=>[r("div",Ue,[i(d,null,{default:m(()=>[i(y)]),_:1}),Be])]),_:1}),i(_,{to:"/bangumi"},{default:m(()=>[r("div",ze,[i(d,null,{default:m(()=>[i(g)]),_:1}),He])]),_:1}),i(_,{to:"/nihongo"},{default:m(()=>[r("div",Ye,[i(d,null,{default:m(()=>[i(N)]),_:1}),Ke])]),_:1}),i(_,{to:"/learn"},{default:m(()=>[r("div",Qe,[i(d,null,{default:m(()=>[i(R)]),_:1}),We])]),_:1}),i(_,{to:"/about"},{default:m(()=>[r("div",Ze,[i(d,null,{default:m(()=>[i(F)]),_:1}),Je])]),_:1})]),o.islogin?(h(),f("div",Xe,[r("div",Ge,[i(P,{size:"small",src:"https://q1.qlogo.cn/g?b=qq&nk="+this.user+"&s=640"},null,8,["src"]),r("div",et,[i(_,{to:"/user"},{default:m(()=>[tt]),_:1}),o.userAuth?(h(),f("div",ot)):b("",!0),i(_,{to:"/mylove"},{default:m(()=>[o.userAuth?(h(),f("div",st,"\u6211\u7684\u6536\u85CF")):b("",!0)]),_:1}),nt,r("a",{onClick:t[0]||(t[0]=(...w)=>s.exit&&s.exit(...w)),href:"#"},it)])]),r("div",rt,[i(_,{to:"/manage/films"},{default:m(()=>[lt]),_:1})])])):b("",!0),o.islogin?b("",!0):(h(),f("div",ct,[r("div",dt,[i(P,{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"})]),r("div",ut,[mt,r("div",_t,[r("div",{class:"user-menu-item",onClick:t[1]||(t[1]=(...w)=>s.goLogin&&s.goLogin(...w))},"\u767B\u5F55/\u6CE8\u518C")])])]))])}var pt=I(qe,[["render",ht],["__scopeId","data-v-3b0d21f8"]]);const ft={name:"Footer",data(){return{}},components:{}},D=e=>(S("data-v-4f6f6a1a"),e=e(),A(),e),gt=D(()=>r("canvas",{class:"fireworks",style:{position:"fixed",left:"0",top:"0","z-index":"999","pointer-events":"none"}},null,-1)),vt=D(()=>r("footer",null,"Copyright \xA9 2020-2021 \u522B\u52A8\u6211\u7ED3\u83DC",-1));function yt(e,t,c,l,o,s){return h(),f(V,null,[gt,vt],64)}var bt=I(ft,[["render",yt],["__scopeId","data-v-4f6f6a1a"]]);const It={name:"App",data(){return{islogin:!1,ishow:!1,cloud:E.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,dialogVisible:!0}},computed:{isLogin(){return this.$store.state.islogin}},created(){this.auth=this.cloud.auth({persistence:"local"});const e=this.auth.currentUser;e&&localStorage.setItem("openid",e.uid);var t=document.location.protocol!="https:";console.log(t),t&&window.location.hostname!=="localhost"&&(window.location="https://site.shuiao.top"),this.auth.hasLoginState&&localStorage.getItem("login_type_yui-7gel1hqtaf6fb79d")||this.nmlogin();const c=this.cloud.database();c.command,c.collection("user").where({email:localStorage.getItem("yui_login_user")}).get().then(l=>{const o=l.data;!!l.data&&!!o[0]&&(o[0].isEffect==="1"&&o[0].uauth==="0"?localStorage.setItem("user_auth","admin"):localStorage.setItem("user_auth","normal"))})},components:{Login:Oe,Header:pt,Footer:bt},methods:{appClick(e){console.log(e),e.target.localName=="aside"&&this.$store.commit("noincrement")},async nmlogin(){const e=this.cloud.auth({persistence:"local"});await e.anonymousAuthProvider().signIn();const t=await e.getLoginState();console.log(t.isAnonymousAuth),window.location.reload()},confirm(){this.dialogVisible=!1,this.nmlogin()},goLogin(){this.$store.commit("increment"),this.dialogVisible=!1}}};function Et(e,t,c,l,o,s){const a=p("Header"),d=p("router-view"),_=p("Login"),y=p("Footer");return h(),f("div",{class:C({s_main:!s.isLogin,a_main:s.isLogin}),onClick:t[1]||(t[1]=j((...g)=>e.hideAside&&e.hideAside(...g),["self"]))},[i(a),r("main",null,[i(d,null,{default:m(({Component:g})=>[i(U,null,{default:m(()=>[(h(),x(z,null,[(h(),x(B(g)))],1024))]),_:2},1024)]),_:1})]),s.isLogin?(h(),f("aside",{key:0,class:C({noshow:o.ishow}),onClick:t[0]||(t[0]=(...g)=>s.appClick&&s.appClick(...g))},[i(_)],2)):b("",!0),i(y)],2)}var wt=I(It,[["render",Et],["__scopeId","data-v-77ae4388"]]);const St="modulepreload",O={},At="/",u=function(t,c){return!c||c.length===0?t():Promise.all(c.map(l=>{if(l=`${At}${l}`,l in O)return;O[l]=!0;const o=l.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${s}`))return;const a=document.createElement("link");if(a.rel=o?"stylesheet":St,o||(a.as="script",a.crossOrigin=""),a.href=l,document.head.appendChild(a),o)return new Promise((d,_)=>{a.addEventListener("load",d),a.addEventListener("error",_)})})).then(()=>t())},Lt=()=>u(()=>import("./Shouye.c4c7b1a6.js"),["assets/Shouye.c4c7b1a6.js","assets/Shouye.1f4c068e.css","assets/vendor.dd298bfa.js","assets/NewsItem.aaad712f.js","assets/NewsItem.2da22fc5.css"]),Tt=()=>u(()=>import("./Top.3811156f.js"),["assets/Top.3811156f.js","assets/Top.4301bd42.css","assets/vendor.dd298bfa.js"]),Pt=()=>u(()=>import("./Share.0159fa41.js"),["assets/Share.0159fa41.js","assets/Share.a89af4c3.css","assets/vendor.dd298bfa.js"]),kt=()=>u(()=>import("./Chat.a57dfc65.js"),["assets/Chat.a57dfc65.js","assets/Chat.dd5e87cd.css","assets/vendor.dd298bfa.js"]),$t=()=>u(()=>import("./About.a14f82e0.js"),["assets/About.a14f82e0.js","assets/About.65904fc3.css","assets/vendor.dd298bfa.js"]),Vt=()=>u(()=>import("./User.acf466f0.js"),["assets/User.acf466f0.js","assets/User.eb970f1f.css","assets/vendor.dd298bfa.js"]),Ct=()=>u(()=>import("./Manage.64ef8880.js"),["assets/Manage.64ef8880.js","assets/Manage.0c302983.css","assets/vendor.dd298bfa.js"]),xt=()=>u(()=>import("./FilmsManage.a3b84a4b.js"),["assets/FilmsManage.a3b84a4b.js","assets/FilmsManage.842b643b.css","assets/vendor.dd298bfa.js","assets/FilmsUpload.8d57526c.js","assets/FilmsUpload.ff375b6d.css"]),Mt=()=>u(()=>import("./FilmsUpload.8d57526c.js"),["assets/FilmsUpload.8d57526c.js","assets/FilmsUpload.ff375b6d.css","assets/vendor.dd298bfa.js"]),Dt=()=>u(()=>import("./UserManage.72a70e14.js"),["assets/UserManage.72a70e14.js","assets/UserManage.49ef573f.css","assets/vendor.dd298bfa.js"]),Ot=()=>u(()=>import("./FilmsMore.2ffc755f.js"),["assets/FilmsMore.2ffc755f.js","assets/FilmsMore.31ad3db9.css","assets/vendor.dd298bfa.js"]),qt=()=>u(()=>import("./Bangumi.849868a8.js"),["assets/Bangumi.849868a8.js","assets/Bangumi.3add37b6.css","assets/vendor.dd298bfa.js"]),Nt=()=>u(()=>import("./Nihongo.60479ed5.js"),["assets/Nihongo.60479ed5.js","assets/Nihongo.ec8f4914.css","assets/vendor.dd298bfa.js"]),Rt=()=>u(()=>import("./Learn.8be7cb14.js"),["assets/Learn.8be7cb14.js","assets/Learn.4a252a5b.css","assets/vendor.dd298bfa.js"]),Ft=()=>u(()=>import("./FilmDetail.4c2cdddf.js"),["assets/FilmDetail.4c2cdddf.js","assets/FilmDetail.d11c613e.css","assets/FilmsBox.080bf4d7.js","assets/FilmsBox.fd973d2b.css","assets/vendor.dd298bfa.js","assets/FilmsUpload.8d57526c.js","assets/FilmsUpload.ff375b6d.css"]),jt=()=>u(()=>import("./MyLove.a9ccb8c7.js"),["assets/MyLove.a9ccb8c7.js","assets/MyLove.a4262ca3.css","assets/vendor.dd298bfa.js"]),Ut=()=>u(()=>import("./FilmsCard.23e34e0f.js"),["assets/FilmsCard.23e34e0f.js","assets/FilmsBox.080bf4d7.js","assets/FilmsBox.fd973d2b.css","assets/vendor.dd298bfa.js"]),q=()=>u(()=>import("./NewsCard.144d94dd.js"),["assets/NewsCard.144d94dd.js","assets/NewsCard.cb5670e8.css","assets/NewsItem.aaad712f.js","assets/NewsItem.2da22fc5.css","assets/vendor.dd298bfa.js"]),Bt=()=>u(()=>import("./MusicCard.de25b994.js"),["assets/MusicCard.de25b994.js","assets/MusicCard.cca693da.css","assets/vendor.dd298bfa.js"]),zt=()=>u(()=>import("./MuiscManage.67e53c8c.js"),["assets/MuiscManage.67e53c8c.js","assets/vendor.dd298bfa.js"]),Ht=[{path:"/",name:"/",component:Lt,children:[{path:"/",component:q},{path:"/shouye",component:q},{path:"shouye/filmscard",component:Ut},{path:"shouye/musicard",component:Bt}]},{path:"/top",name:"top",component:Tt},{path:"/share",name:"share",component:Pt},{path:"/chat",name:"chat",component:kt},{path:"/about",name:"about",component:$t},{path:"/user",name:"user",component:Vt},{path:"/manage",name:"manage",children:[{path:"films",component:xt},{path:"upload",component:Mt},{path:"user",component:Dt},{path:"music",component:zt}],component:Ct},{path:"/filmsmore",name:"filmsmore",component:Ot},{path:"/bangumi",name:"bangumi",component:qt},{path:"/nihongo",name:"nihongo",component:Nt},{path:"/learn",name:"learn",component:Rt},{path:"/filmdetail/:id",name:"filmdetail",component:Ft},{path:"/mylove",name:"mylove",component:jt}],Yt=H({history:Y(),routes:Ht,scrollBehavior(e,t,c){return{top:0}}}),Kt=K({state(){return{islogin:!1,loginStatus:!1}},mutations:{increment(e){e.islogin=!0},noincrement(e){e.islogin=!1},inlogin(e){e.loginStatus=!0},nologin(e){e.loginStatus=!1}}});const Qt={data(){return{fomatTime:""}},props:["time","type"],computed:{fomatTime:function(){return this.fomatTime=this.$moment(this.time).format("YYYY-MM-DD hh:mm:ss"),this.fomatTime},FromNow:function(){return this.fomatTime=this.$moment(this.time).FromNow(),this.fomatTime}},created(){console.log(document.getElementsByClassName("shuite-timer"))},components:{}},Wt={key:0},Zt={key:1};function Jt(e,t,c,l,o,s){return h(),f(V,null,[c.type?b("",!0):(h(),f("span",Wt,L(s.fomatTime),1)),c.type=="1"?(h(),f("span",Zt,L(s.FromNow),1)):b("",!0)],64)}var Xt=I(Qt,[["render",Jt]]);const Gt={data(){return{}},setup(){return{input:Q("")}},props:{swidth:{default:700},subname:{default:"\u641C\u7D22"}},created(){},methods:{searchFunc(){this.$emit("search")}},components:{}},eo={class:"shuite-input boxshadow"};function to(e,t,c,l,o,s){const a=p("el-input"),d=p("el-button");return h(),f("div",eo,[i(a,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",modelValue:l.input,"onUpdate:modelValue":t[0]||(t[0]=_=>l.input=_),clearable:"",class:"shuite-search"},null,8,["modelValue"]),i(d,{onClick:s.searchFunc,type:"small",style:{height:"40px","margin-left":"10px","margin-right":"10px"}},{default:m(()=>[v(L(c.subname),1)]),_:1},8,["onClick"])])}var oo=I(Gt,[["render",to],["__scopeId","data-v-4e421cb4"]]);const n=W(wt);n.use(Z,{locale:J});n.component("baseball",X);n.component("calendar",G);n.component("house",ee);n.component("school",te);n.component("notebook",oe);n.component("star",se);n.component("question-filled",ne);n.component("user",ae);n.component("close",ie);n.component("link",re);n.component("expand",le);n.component("fold",ce);n.component("location",de);n.component("setting",ue);n.component("upload",me);n.component("ship",_e);n.component("video-camera",he);n.component("mic",pe);n.component("paperclip",fe);n.component("chat-round",ge);n.component("edit",ve);n.component("more-filled",ye);n.component("trophy",be);n.component("milkTea",Ie);n.component("bell",Ee);n.config.globalProperties.$scrollReveal=we;n.config.globalProperties.$axios=Se;n.config.globalProperties.$cloudbase=E;n.config.globalProperties.$moment=Ae;n.config.globalProperties.$ElMessage=Le;n.component("Timer",Xt);n.component("shuite-input",oo);E.init({env:"yui-7gel1hqtaf6fb79d"});const so=E.auth({persistence:"local"});n.config.globalProperties.$auth=so;n.use(Yt);n.use(Kt);n.mount("#app");export{oo as S,I as _};

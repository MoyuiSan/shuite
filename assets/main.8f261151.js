import{c as A,o as m,a as f,w as $,v as V,b as l,p as w,d as E,e as y,r as p,f as a,g as _,h as g,F as N,n as C,i as z,j as k,k as D,K as H,l as Y,m as K,q as Q,t as L,s as W,u as Z,x as J,z as X,B as G,C as ee,H as te,S as oe,N as se,y as ne,A as ae,Q as ie,U as re,D as le,L as ce,E as ue,G as de,I as me,J as _e,M as he,O as pe,V as fe,P as ge,R as ve,T as ye,W as be,X as Ie,Y as Se,Z as Ae,_ as we,$ as Ee,a0 as ke,a1 as Le,a2 as Te,a3 as Pe,a4 as $e}from"./vendor.3a7c3f84.js";const Ve=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}};Ve();var S=(e,t)=>{const c=e.__vccOpts||e;for(const[r,o]of t)c[r]=o;return c};AV;const Ne={name:"Login",data(){return{cloud:A.init({env:"yui-7gel1hqtaf6fb79d"}),email:"",password:"",test:""}},computed:{test(){return this.$store.state.islogin}},created(){AV.init({appId:"tYNddUiQgK4ghsF9PDzRiz2j-MdYXbMMI",appKey:"I3DfpmsVmqqeA66CARr0H1Br"})},mounted(){const e=new AV.Query("userinfo");e.equalTo("email",this.email),e.find().then(t=>{console.log(t)})},methods:{register(){NProgress.start();const e=this.email;/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(e)?this.cloud.auth().signUpWithEmailAndPassword(this.email,this.password).then(()=>{NProgress.done()}).catch(c=>{c&&this.$ElMessage.error("\u90AE\u7BB1\u5DF2\u5B58\u5728\uFF01"),NProgress.done()}):(alert("\u90AE\u7BB1\u683C\u5F0F\u4E0D\u6B63\u786E"),NProgress.done())},login(){NProgress.start(),this.cloud.auth({persistence:"local"}).signInWithEmailAndPassword(this.email,this.password).then(t=>{localStorage.setItem("yui_login_user",this.email);const c=new AV.Query("userinfo");c.equalTo("email",this.email);const r=this.cloud.database();r.command;const n=this.cloud.auth({persistence:"local"}).currentUser;r.collection("user").where({email:this.email}).get().then(i=>{if(!!i.data[0]||localStorage.getItem("uesr_auth")=="normal")return!1;r.collection("user").add({email:this.email,uauth:"1",created:Date.now(),updated:Date.now(),isEffect:"1",uid:n.uid}).then(u=>{console.log(u)})}),r.collection("user").where({email:localStorage.getItem("yui_login_user")}).get().then(i=>{const u=i.data;i.data&&(u[0].isEffect==="1"&&u[0].uauth==="0"?localStorage.setItem("user_auth","admin"):localStorage.setItem("user_auth","normal"))}),c.find().then(i=>{if(!i){const h=AV.Object.extend("userinfo"),b=new h;b.set("nickname","\u65E0\u540D\u4EBA\u58EB"),b.set("email",this.email),b.save().then(v=>{console.log(`\u4FDD\u5B58\u6210\u529F\u3002objectId\uFF1A${v.id}`)},v=>{ElMessage.error("\u6570\u636E\u4FDD\u5B58\u5931\u8D25!")})}let u=setTimeout(()=>{this.$store.commit("increment"),NProgress.done(),window.location.reload(),clearTimeout(u)},500);u=null})});let e=setTimeout(()=>{localStorage.getItem("yui_login_user")||ElMessage.error("\u8D26\u6237\u5BC6\u7801\u9519\u8BEF!"),NProgress.done(),clearTimeout(e)},2e3);e=null}}},M=e=>(w("data-v-d4f45df8"),e=e(),E(),e),Ce={class:"login boxshadow"},De=M(()=>l("h2",null,"\u767B\u5F55",-1)),Me={class:"register"},xe=y("\u6CA1\u6709\u8D26\u53F7?"),Oe={class:"btn"},qe=M(()=>l("button",null,"\u91CD\u7F6E",-1));function Re(e,t,c,r,o,n){return m(),f("div",Ce,[De,$(l("input",{type:"email",placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u90AE\u7BB1","onUpdate:modelValue":t[0]||(t[0]=i=>o.email=i)},null,512),[[V,o.email]]),$(l("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=i=>o.password=i),placeholder:"\u8BF7\u8F93\u5165\u4F60\u7684\u5BC6\u7801"},null,512),[[V,o.password]]),l("div",Me,[xe,l("span",{onClick:t[2]||(t[2]=(...i)=>n.register&&n.register(...i))},"\u6CE8\u518C\u4E00\u4E0B")]),l("div",Oe,[l("button",{onClick:t[3]||(t[3]=(...i)=>n.login&&n.login(...i))},"\u767B\u9646"),qe])])}var Fe=S(Ne,[["render",Re],["__scopeId","data-v-d4f45df8"]]);const je={data(){return{userAuth:localStorage.getItem("user_auth")=="admin",islogin:!1,cloud:cloudbase.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,user:localStorage.getItem("yui_login_user"),menuStatus:!1}},computed:{},created(){this.auth=this.cloud.auth({persistence:"local"}),console.log(localStorage.getItem("user_auth")),localStorage.getItem("access_token_yui-7gel1hqtaf6fb79d")?JSON.parse(localStorage.getItem("login_type_yui-7gel1hqtaf6fb79d")).content==="ANONYMOUS"?console.log("\u533F\u540D\u767B\u5F55\u4E2D"):this.islogin=!0:this.islogin=!1},mounted(){},methods:{exit(){localStorage.removeItem("login_type_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("user_info_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("refresh_token_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("yui_login_user"),localStorage.removeItem("access_token_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("access_token_expire_yui-7gel1hqtaf6fb79d"),localStorage.removeItem("user_auth"),localStorage.removeItem("anonymous_uuid_yui-7gel1hqtaf6fb79d"),window.location.reload()},goLogin(){this.$store.commit("increment")},showAsideNav(){this.$store.commit("showAsideNav")}},components:{}},T=e=>(w("data-v-65ce9011"),e=e(),E(),e),Ue={class:"h-normal"},Be={class:"header-left"},ze=y("\u7BA1\u7406 "),He={class:"header-left-item"},Ye=y("\u9996\u9875 "),Ke={class:"header-left-item"},Qe=y("\u8FFD\u756A "),We={class:"header-left-item header-left-noshow"},Ze=y("\u65E5\u8BED "),Je={class:"header-left-item header-left-noshow"},Xe=y("\u77E5\u8BC6\u5E93 "),Ge={class:"header-left-item"},et=y("\u5173\u4E8E "),tt={key:0,class:"header-right"},ot={class:"header-right-item header-right-menu"},st={class:"user-menu"},nt=T(()=>l("div",{class:"user-menu-item"},"\u6211\u7684\u4FE1\u606F",-1)),at={key:0,class:"line"},it={key:0,class:"user-menu-item"},rt=T(()=>l("div",{class:"line"},null,-1)),lt=T(()=>l("div",{class:"user-menu-item"},"\u9000\u51FA\u767B\u5F55",-1)),ct=[lt],ut=y("\u7BA1\u7406"),dt=y("\u91CD\u7F6E "),mt={key:1,class:"header-right"},_t={class:"header-right-item"},ht={class:"header-right-item header-right-menu"},pt=y(" \u767B\u5F55 "),ft={class:"user-menu"};function gt(e,t,c,r,o,n){const i=p("fold"),u=p("el-icon"),h=p("router-link"),b=p("house"),v=p("calendar"),R=p("school"),F=p("milkTea"),j=p("question-filled"),P=p("el-avatar"),U=p("setting"),B=p("refresh");return m(),f("header",Ue,[l("div",Be,[a(h,{to:"/manage/films"},{default:_(()=>[o.menuStatus?(m(),f("div",{key:0,class:"header-left-item",onClick:t[0]||(t[0]=(...I)=>n.showAsideNav&&n.showAsideNav(...I))},[a(u,null,{default:_(()=>[a(i)]),_:1}),ze])):g("",!0)]),_:1}),a(h,{to:"/"},{default:_(()=>[l("div",He,[a(u,null,{default:_(()=>[a(b)]),_:1}),Ye])]),_:1}),a(h,{to:"/bangumi"},{default:_(()=>[l("div",Ke,[a(u,null,{default:_(()=>[a(v)]),_:1}),Qe])]),_:1}),a(h,{to:"/nihongo"},{default:_(()=>[l("div",We,[a(u,null,{default:_(()=>[a(R)]),_:1}),Ze])]),_:1}),a(h,{to:"/learn"},{default:_(()=>[l("div",Je,[a(u,null,{default:_(()=>[a(F)]),_:1}),Xe])]),_:1}),a(h,{to:"/about"},{default:_(()=>[l("div",Ge,[a(u,null,{default:_(()=>[a(j)]),_:1}),et])]),_:1})]),o.islogin?(m(),f("div",tt,[l("div",ot,[a(P,{size:"small",src:"https://q1.qlogo.cn/g?b=qq&nk="+this.user+"&s=640"},null,8,["src"]),l("div",st,[a(h,{to:"/user"},{default:_(()=>[nt]),_:1}),o.userAuth?(m(),f("div",at)):g("",!0),a(h,{to:"/mylove"},{default:_(()=>[o.userAuth?(m(),f("div",it,"\u6211\u7684\u6536\u85CF")):g("",!0)]),_:1}),rt,l("a",{onClick:t[1]||(t[1]=(...I)=>n.exit&&n.exit(...I)),href:"#"},ct)])]),o.menuStatus?g("",!0):(m(),f("div",{key:0,class:"header-right-item",onClick:t[2]||(t[2]=I=>o.menuStatus=!0)},[a(h,{to:"/manage/upload"},{default:_(()=>[a(u,null,{default:_(()=>[a(U)]),_:1}),ut]),_:1})])),o.menuStatus?(m(),f("div",{key:1,class:"header-right-item",onClick:t[3]||(t[3]=I=>o.menuStatus=!1)},[a(u,null,{default:_(()=>[a(B)]),_:1}),dt])):g("",!0)])):g("",!0),o.islogin?g("",!0):(m(),f("div",mt,[l("div",_t,[a(P,{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"})]),l("div",ht,[pt,l("div",ft,[l("div",{class:"user-menu-item",onClick:t[4]||(t[4]=(...I)=>n.goLogin&&n.goLogin(...I))},"\u767B\u5F55/\u6CE8\u518C")])])]))])}var vt=S(je,[["render",gt],["__scopeId","data-v-65ce9011"]]);const yt={name:"Footer",data(){return{}},components:{}},x=e=>(w("data-v-4f6f6a1a"),e=e(),E(),e),bt=x(()=>l("canvas",{class:"fireworks",style:{position:"fixed",left:"0",top:"0","z-index":"999","pointer-events":"none"}},null,-1)),It=x(()=>l("footer",null,"Copyright \xA9 2020-2021 \u522B\u52A8\u6211\u7ED3\u83DC",-1));function St(e,t,c,r,o,n){return m(),f(N,null,[bt,It],64)}var At=S(yt,[["render",St],["__scopeId","data-v-4f6f6a1a"]]);const wt={name:"App",step(){},data(){return{islogin:!1,ishow:!1,cloud:A.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,dialogVisible:!0}},computed:{isLogin(){return this.$store.state.islogin}},created(){this.auth=this.cloud.auth({persistence:"local"});const e=this.auth.currentUser;e&&localStorage.setItem("openid",e.uid);var t=document.location.protocol!="https:";console.log(t),t&&window.location.hostname!=="localhost"&&(window.location="https://site.shuiao.top"),this.auth.hasLoginState&&localStorage.getItem("login_type_yui-7gel1hqtaf6fb79d")||this.nmlogin();const c=this.cloud.database();c.command,c.collection("user").where({email:localStorage.getItem("yui_login_user")}).get().then(r=>{const o=r.data;!!r.data&&!!o[0]&&(o[0].isEffect==="1"&&o[0].uauth==="0"?localStorage.setItem("user_auth","admin"):localStorage.setItem("user_auth","normal"))})},components:{Login:Fe,Header:vt,Footer:At},methods:{appClick(e){console.log(e),e.target.localName=="aside"&&this.$store.commit("noincrement")},async nmlogin(){const e=this.cloud.auth({persistence:"local"});await e.anonymousAuthProvider().signIn();const t=await e.getLoginState();console.log(t.isAnonymousAuth),window.location.reload()},confirm(){this.dialogVisible=!1,this.nmlogin()},goLogin(){this.$store.commit("increment"),this.dialogVisible=!1}}};function Et(e,t,c,r,o,n){const i=p("Header"),u=p("router-view"),h=p("Login"),b=p("Footer");return m(),f("div",{class:C({s_main:!n.isLogin,a_main:n.isLogin}),onClick:t[1]||(t[1]=z((...v)=>e.hideAside&&e.hideAside(...v),["self"]))},[a(i),l("main",null,[a(u,null,{default:_(({Component:v})=>[(m(),k(H,null,[e.$route.meta.keepAlive?(m(),k(D(v),{key:0})):g("",!0)],1024)),e.$route.meta.keepAlive?g("",!0):(m(),k(D(v),{key:0}))]),_:1})]),n.isLogin?(m(),f("aside",{key:0,class:C({noshow:o.ishow}),onClick:t[0]||(t[0]=(...v)=>n.appClick&&n.appClick(...v))},[a(h)],2)):g("",!0),a(b)],2)}var kt=S(wt,[["render",Et],["__scopeId","data-v-3cc38f80"]]);const Lt="modulepreload",O={},Tt="/",d=function(t,c){return!c||c.length===0?t():Promise.all(c.map(r=>{if(r=`${Tt}${r}`,r in O)return;O[r]=!0;const o=r.endsWith(".css"),n=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${n}`))return;const i=document.createElement("link");if(i.rel=o?"stylesheet":Lt,o||(i.as="script",i.crossOrigin=""),i.href=r,document.head.appendChild(i),o)return new Promise((u,h)=>{i.addEventListener("load",u),i.addEventListener("error",h)})})).then(()=>t())},Pt=()=>d(()=>import("./Shouye.4cb52433.js"),["assets/Shouye.4cb52433.js","assets/Shouye.1f4c068e.css","assets/vendor.3a7c3f84.js","assets/NewsItem.1786eac0.js","assets/NewsItem.c0cfb73e.css"]),$t=()=>d(()=>import("./Top.c78e83ea.js"),["assets/Top.c78e83ea.js","assets/Top.4301bd42.css","assets/vendor.3a7c3f84.js"]),Vt=()=>d(()=>import("./Share.0526c010.js"),["assets/Share.0526c010.js","assets/Share.a89af4c3.css","assets/vendor.3a7c3f84.js"]),Nt=()=>d(()=>import("./Chat.2d723aaf.js"),["assets/Chat.2d723aaf.js","assets/Chat.82ade952.css","assets/vendor.3a7c3f84.js"]),Ct=()=>d(()=>import("./About.334c567f.js"),["assets/About.334c567f.js","assets/About.65904fc3.css","assets/vendor.3a7c3f84.js"]),Dt=()=>d(()=>import("./User.3cfec79f.js"),["assets/User.3cfec79f.js","assets/User.eb970f1f.css","assets/vendor.3a7c3f84.js"]),Mt=()=>d(()=>import("./Manage.2c23b953.js"),["assets/Manage.2c23b953.js","assets/Manage.c0f36a93.css","assets/vendor.3a7c3f84.js"]),xt=()=>d(()=>import("./FilmsManage.6935d483.js"),["assets/FilmsManage.6935d483.js","assets/FilmsManage.a7f0a5e8.css","assets/vendor.3a7c3f84.js","assets/FilmsUpload.450f140f.js","assets/FilmsUpload.3ef6c25c.css"]),Ot=()=>d(()=>import("./FilmsUpload.450f140f.js"),["assets/FilmsUpload.450f140f.js","assets/FilmsUpload.3ef6c25c.css","assets/vendor.3a7c3f84.js"]),qt=()=>d(()=>import("./UserManage.be6d473a.js"),["assets/UserManage.be6d473a.js","assets/UserManage.4910776d.css","assets/vendor.3a7c3f84.js"]),Rt=()=>d(()=>import("./FilmsMore.a7e7835b.js"),["assets/FilmsMore.a7e7835b.js","assets/FilmsMore.bc1199b1.css","assets/vendor.3a7c3f84.js"]),Ft=()=>d(()=>import("./Bangumi.e10ba716.js"),["assets/Bangumi.e10ba716.js","assets/Bangumi.6331e3e1.css","assets/vendor.3a7c3f84.js"]),jt=()=>d(()=>import("./Nihongo.e436ed9e.js"),["assets/Nihongo.e436ed9e.js","assets/Nihongo.b19ab4a0.css","assets/vendor.3a7c3f84.js"]),Ut=()=>d(()=>import("./Learn.3349df1e.js"),["assets/Learn.3349df1e.js","assets/Learn.4a252a5b.css","assets/vendor.3a7c3f84.js"]),Bt=()=>d(()=>import("./FilmDetail.f233ae40.js"),["assets/FilmDetail.f233ae40.js","assets/FilmDetail.e8586ba6.css","assets/FilmsBox.9914ca18.js","assets/FilmsBox.fd973d2b.css","assets/vendor.3a7c3f84.js","assets/FilmsUpload.450f140f.js","assets/FilmsUpload.3ef6c25c.css"]),zt=()=>d(()=>import("./MyLove.53fdd5e5.js"),["assets/MyLove.53fdd5e5.js","assets/MyLove.0c1af908.css","assets/vendor.3a7c3f84.js"]),Ht=()=>d(()=>import("./FilmsCard.ba4cc3a4.js"),["assets/FilmsCard.ba4cc3a4.js","assets/FilmsBox.9914ca18.js","assets/FilmsBox.fd973d2b.css","assets/vendor.3a7c3f84.js"]),q=()=>d(()=>import("./NewsCard.eb1ecbd2.js"),["assets/NewsCard.eb1ecbd2.js","assets/NewsCard.dbad340d.css","assets/NewsItem.1786eac0.js","assets/NewsItem.c0cfb73e.css","assets/vendor.3a7c3f84.js"]),Yt=()=>d(()=>import("./MusicCard.508ed549.js"),["assets/MusicCard.508ed549.js","assets/MusicCard.cca693da.css","assets/vendor.3a7c3f84.js"]),Kt=()=>d(()=>import("./MuiscManage.13d1f75c.js"),["assets/MuiscManage.13d1f75c.js","assets/vendor.3a7c3f84.js"]),Qt=[{path:"/",component:Pt,children:[{path:"/",component:q,meta:{keepAlive:!0}},{path:"/shouye",component:q},{path:"shouye/filmscard",component:Ht},{path:"shouye/musicard",component:Yt}]},{path:"/top",name:"top",component:$t},{path:"/share",name:"share",component:Vt},{path:"/chat",name:"chat",component:Nt},{path:"/about",name:"about",component:Ct},{path:"/user",name:"user",component:Dt},{path:"/manage",name:"manage",children:[{path:"films",component:xt},{path:"upload",component:Ot},{path:"user",component:qt},{path:"music",component:Kt}],component:Mt},{path:"/filmsmore",name:"filmsmore",component:Rt},{path:"/bangumi",name:"bangumi",component:Ft},{path:"/nihongo",name:"nihongo",component:jt},{path:"/learn",name:"learn",component:Ut},{path:"/filmdetail/:id",name:"filmdetail",component:Bt},{path:"/mylove",name:"mylove",component:zt}],Wt=Y({history:K(),routes:Qt,scrollBehavior(e,t,c){return{top:0}}}),Zt=Q({state(){return{asideNavStatus:!0}},mutations:{showAsideNav(e){e.asideNavStatus=!0},hideAsideNav(e){e.asideNavStatus=!1}}});const Jt={data(){return{fomatTime:""}},props:["time","type"],computed:{fomatTime:function(){return this.fomatTime=this.$moment(this.time).format("YYYY-MM-DD hh:mm:ss"),this.fomatTime},FromNow:function(){return this.fomatTime=this.$moment(this.time).FromNow(),this.fomatTime}},created(){console.log(document.getElementsByClassName("shuite-timer"))},components:{}},Xt={key:0},Gt={key:1};function eo(e,t,c,r,o,n){return m(),f(N,null,[c.type?g("",!0):(m(),f("span",Xt,L(n.fomatTime),1)),c.type=="1"?(m(),f("span",Gt,L(n.FromNow),1)):g("",!0)],64)}var to=S(Jt,[["render",eo]]);const oo={data(){return{}},setup(){return{input:W("")}},props:{swidth:{default:700},subname:{default:"\u641C\u7D22"}},created(){},methods:{searchFunc(){this.$emit("search")}},components:{}},so={class:"shuite-input boxshadow"};function no(e,t,c,r,o,n){const i=p("el-input"),u=p("el-button");return m(),f("div",so,[a(i,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",modelValue:r.input,"onUpdate:modelValue":t[0]||(t[0]=h=>r.input=h),clearable:"",class:"shuite-search"},null,8,["modelValue"]),a(u,{onClick:n.searchFunc,type:"small",style:{height:"40px","margin-left":"10px","margin-right":"10px"}},{default:_(()=>[y(L(c.subname),1)]),_:1},8,["onClick"])])}var ao=S(oo,[["render",no],["__scopeId","data-v-4e421cb4"]]);const s=Z(kt);s.use(J,{locale:X});s.component("baseball",G);s.component("calendar",ee);s.component("house",te);s.component("school",oe);s.component("notebook",se);s.component("star",ne);s.component("star-filled",ae);s.component("question-filled",ie);s.component("user",re);s.component("close",le);s.component("link",ce);s.component("expand",ue);s.component("fold",de);s.component("location",me);s.component("setting",_e);s.component("upload",he);s.component("ship",pe);s.component("video-camera",fe);s.component("mic",ge);s.component("paperclip",ve);s.component("chat-round",ye);s.component("edit",be);s.component("more-filled",Ie);s.component("trophy",Se);s.component("milkTea",Ae);s.component("bell",we);s.component("refresh",Ee);s.component("delete",ke);s.config.globalProperties.$scrollReveal=Le;s.config.globalProperties.$axios=Te;s.config.globalProperties.$cloudbase=A;s.config.globalProperties.$moment=Pe;s.config.globalProperties.$ElMessage=$e;s.component("Timer",to);s.component("shuite-input",ao);A.init({env:"yui-7gel1hqtaf6fb79d"});const io=A.auth({persistence:"local"});s.config.globalProperties.$auth=io;s.use(Wt);s.use(Zt);s.mount("#app");export{ao as S,S as _};

import{c as D,s as C,r as s,o as u,a as F,f as a,g as r,b as x,j as V,h as y,F as v,e as h}from"./vendor.3249e4ba.js";import T from"./FilmsUpload.a2b84cc4.js";import{_ as k}from"./main.6a54a368.js";const S={data(){return{tableData:[],currentPage:1,cloud:D.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,currentData:{},isEdit:!1,page:1,total:0,dialogTableVisible:!1}},setup(){return{input:C("")}},created(){this.auth=this.cloud.auth({persistence:"local"}),this.getFilmsData(10);const e=this.cloud.database();e.command,e.collection("films").count().then(t=>{console.log(t.total),this.total=t.total})},methods:{getFilmsData(e){const t=this.cloud.database();t.command,t.collection("films").orderBy("created","desc").limit(e).skip((this.page-1)*e).get().then(i=>{this.tableData=i.data})},getFilmsDataByName(e){const t=this.cloud.database();t.command;const i=new t.RegExp({regexp:e,options:"i"});t.collection("films").where({name:i}).get().then(c=>{this.tableData=c.data,console.log(c)})},handleSizeChange(e){console.log(`\u6BCF\u9875 ${e} \u6761`),this.getFilmsData(e)},handleCurrentChange(e){console.log(`\u5F53\u524D\u9875: ${e}`),this.page=e,this.getFilmsData(10)},handleClick(e){this.currentData=e,console.log(e,"1231312"),this.dialogTableVisible=!0},hideModel(e){console.log(e.target.className),e.target.className==="edit-model"&&(this.isEdit=!1,this.getFilmsData(10))},hideDialog(){this.dialogTableVisible=!1,this.getFilmsData(10)},formatterTime(e,t,i,c){return moment(i).format("YYYY/MM/DD")},searchFilms(){this.$refs.ShuiteInput.input?this.getFilmsDataByName(this.$refs.ShuiteInput.input):this.getFilmsData(10)}},components:{"films-upload":T}},z=h("\u7F16\u8F91"),N=h("\u5220\u9664"),B={class:"pageation"};function w(e,t,i,c,l,o){const p=s("shuite-input"),n=s("el-table-column"),m=s("el-button"),g=s("el-table"),_=s("el-pagination"),f=s("films-upload"),b=s("el-dialog");return u(),F(v,null,[a(p,{onSearch:o.searchFilms,ref:"ShuiteInput",class:"films-search"},null,8,["onSearch"]),a(g,{data:l.tableData,"default-sort":{prop:"date",order:"descending"},class:"films-table"},{default:r(()=>[a(n,{prop:"name",label:"\u540D\u5B57",sortable:""}),a(n,{prop:"class",label:"\u7C7B\u522B",sortable:""}),a(n,{prop:"created",label:"\u521B\u5EFA\u65F6\u95F4",formatter:o.formatterTime},null,8,["formatter"]),a(n,{prop:"updated",label:"\u66F4\u65B0\u65F6\u95F4",formatter:o.formatterTime},null,8,["formatter"]),a(n,{fixed:"right",label:"\u64CD\u4F5C",width:"100"},{default:r(d=>[a(m,{onClick:j=>o.handleClick(d.row),type:"text",size:"small"},{default:r(()=>[z]),_:2},1032,["onClick"]),a(m,{type:"text",size:"small"},{default:r(()=>[N]),_:1})]),_:1})]),_:1},8,["data"]),x("div",B,[a(_,{onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange,"current-page":l.currentPage,"page-sizes":[10,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:l.total,style:{"margin-top":"20px"}},null,8,["onSizeChange","onCurrentChange","current-page","total"])]),a(b,{title:"\u66F4\u65B0\u6570\u636E",modelValue:l.dialogTableVisible,"onUpdate:modelValue":t[0]||(t[0]=d=>l.dialogTableVisible=d),top:"5vh",fullscreen:""},{default:r(()=>[l.dialogTableVisible?(u(),V(f,{key:0,type:"2",filmsData:l.currentData,onHideDialog:o.hideDialog},null,8,["filmsData","onHideDialog"])):y("",!0)]),_:1},8,["modelValue"])],64)}var Y=k(S,[["render",w],["__scopeId","data-v-641cf1d9"]]);export{Y as default};

import"./main.7aa2fb9c.js";import e from"./FilmsUpload.35e51a1c.js";import{d as a,i as t,a6 as l,a7 as s,a1 as o,$ as i,f as n,g as r,F as d,a8 as c,Q as m}from"./vendor.7cb940fd.js";const p={data:()=>({tableData:[],currentPage:1,cloud:a.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,currentData:{},isEdit:!1,page:1,total:0,dialogTableVisible:!1}),setup:()=>({input:t("")}),created(){this.auth=this.cloud.auth({persistence:"local"}),this.getFilmsData(10);const e=this.cloud.database();e.command,e.collection("films").count().then((e=>{console.log(e.total),this.total=e.total}))},methods:{getFilmsData(e){const a=this.cloud.database();a.command,a.collection("films").orderBy("created","desc").limit(e).skip((this.page-1)*e).get().then((e=>{this.tableData=e.data}))},getFilmsDataByName(){const e=this.cloud.database();e.command;const a=new e.RegExp({regexp:this.input,options:"i"});e.collection("films").where({name:a}).get().then((e=>{this.tableData=e.data,console.log(e)}))},handleSizeChange(e){console.log(`每页 ${e} 条`),this.getFilmsData(e)},handleCurrentChange(e){console.log(`当前页: ${e}`),this.page=e,this.getFilmsData(10)},handleClick(e){this.currentData=e,this.dialogTableVisible=!0,console.log(e)},hideModel(e){console.log(e.target.className),"edit-model"===e.target.className&&(this.isEdit=!1,this.getFilmsData())},formatter:(e,a,t,l)=>"class"===a.property&&"1"===t?"电视剧":"class"===a.property&&"2"===t?"动漫":"class"===a.property&&"3"===t?"游戏":"class"===a.property&&"4"===t?"其他":void 0,formatterTime:(e,a,t,l)=>moment(t).format("YYYY/MM/DD"),searchFilms(){this.input?this.getFilmsDataByName():this.getFilmsData(10)}},components:{"films-upload":e}},u=c();l("data-v-156c96ed");const h={style:{display:"flex"}},g=m("提交"),f=m("编辑"),b=m("删除"),D={class:"pageation"};s();const C=u(((e,a,t,l,s,c)=>{const m=o("el-input"),p=o("el-button"),C=o("el-table-column"),y=o("el-table"),F=o("el-pagination"),x=o("films-upload"),V=o("el-dialog");return i(),n(d,null,[r("div",h,[r(m,{placeholder:"请输入内容",modelValue:l.input,"onUpdate:modelValue":a[1]||(a[1]=e=>l.input=e),clearable:"",class:"film-search"},null,8,["modelValue"]),r(p,{onClick:c.searchFilms,type:"small",style:{height:"40px","margin-left":"10px"}},{default:u((()=>[g])),_:1},8,["onClick"])]),r(y,{data:s.tableData,"default-sort":{prop:"date",order:"descending"},class:"films-table"},{default:u((()=>[r(C,{prop:"name",label:"名字",sortable:""}),r(C,{prop:"class",label:"类别",sortable:"",formatter:c.formatter},null,8,["formatter"]),r(C,{prop:"link",label:"链接"}),r(C,{prop:"created",label:"创建时间",formatter:c.formatterTime},null,8,["formatter"]),r(C,{fixed:"right",label:"操作",width:"100"},{default:u((e=>[r(p,{onClick:a=>c.handleClick(e.row),type:"text",size:"small"},{default:u((()=>[f])),_:2},1032,["onClick"]),r(p,{type:"text",size:"small"},{default:u((()=>[b])),_:1})])),_:1})])),_:1},8,["data"]),r("div",D,[r(F,{onSizeChange:c.handleSizeChange,onCurrentChange:c.handleCurrentChange,"current-page":s.currentPage,"page-sizes":[10,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:s.total,style:{"margin-top":"20px"}},null,8,["onSizeChange","onCurrentChange","current-page","total"])]),r(V,{title:"更新数据",modelValue:s.dialogTableVisible,"onUpdate:modelValue":a[2]||(a[2]=e=>s.dialogTableVisible=e),top:"5vh",fullscreen:""},{default:u((()=>[r(x,{type:"2",filmsData:s.currentData},null,8,["filmsData"])])),_:1},8,["modelValue"])],64)}));p.render=C,p.__scopeId="data-v-156c96ed";export default p;

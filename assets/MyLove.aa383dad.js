import{_ as u}from"./main.5baf5f19.js";import{r as a,o as l,a as r,j as h,g as n,f as d,h as f,b as s,t as v,p as y,d as g,e as b,F as w,a6 as k}from"./vendor.3a7c3f84.js";const x={data(){return{filmDetail:null,scrollReveal:this.$scrollReveal()}},props:["filmid","loved"],created(){const e=this.$cloudbase.database();e.command,e.collection("films").where({_id:this.filmid}).get().then(t=>{this.filmDetail=t.data[0]}),this.scrollReveal.reveal(".reveal-top",{duration:500,delay:100,origin:"bottom",reset:!0,mobile:!1,distance:"50px",easing:"ease",scale:.9})},mounted(){},methods:{removeMylove(){const e=this.$auth.getAuthHeader(),t=this.$cloudbase.database();t.command,t.collection("mylove").where({_openid:e.uid,filmId:this.filmid}).remove().then(i=>{this.$emit("initdata"),this.$ElMessage.success({message:"\u53D6\u6D88\u6536\u85CF\u4E86!",type:"success"})})}},components:{}},M=e=>(y("data-v-7767cc88"),e=e(),g(),e),L={class:"mylove-card"},S=M(()=>s("div",{class:"image-slot"},[b("\u52A0\u8F7D\u4E2D"),s("span",{class:"dot"},"...")],-1)),C={key:1,class:"mylove-card-msg"};function F(e,t,i,D,o,m){const _=a("el-image"),p=a("router-link"),c=a("delete"),I=a("el-icon"),$=a("el-button");return l(),r("div",L,[o.filmDetail?(l(),h(p,{key:0,to:{name:"filmdetail",params:{id:o.filmDetail._id}}},{default:n(()=>[d(_,{class:"img",src:o.filmDetail.tempFileURL,style:{width:"100%",height:"100%"}},{placeholder:n(()=>[S]),_:1},8,["src"])]),_:1},8,["to"])):f("",!0),o.filmDetail?(l(),r("div",C,[s("span",null,"\u540D\u79F0:"+v(o.filmDetail.name),1),s("span",null,"\u6536\u85CF:"+v(new Date(parseInt(this.loved)).toLocaleDateString()),1)])):f("",!0),d($,{type:"info",circle:"",class:"mylove-card-remove",icon:e.Delete,onClick:m.removeMylove},{default:n(()=>[d(I,null,{default:n(()=>[d(c)]),_:1})]),_:1},8,["icon","onClick"])])}var B=u(x,[["render",F],["__scopeId","data-v-7767cc88"]]);const N={data(){return{data:"",year:Date.parse(new Date().getFullYear())/1e3-8*60*60}},computed:{},created(){this.getMylove()},methods:{getMylove(){this.data="";const e=this.$cloudbase.database(),t=e.command;e.collection("mylove").where({_openid:localStorage.getItem("openid"),updated:t.gt(this.year)}).limit(20).orderBy("created","desc").get().then(i=>{console.log(i),this.data=i.data})}},components:{"film-detail-love":B}},R=e=>(y("data-v-4e109a28"),e=e(),g(),e),V={class:"mylove boxshadow"},j=R(()=>s("h2",null,"\u6211\u7684\u6536\u85CF",-1)),E={class:"mylove-box"};function H(e,t,i,D,o,m){const _=a("el-divider"),p=a("film-detail-love");return l(),r("div",V,[j,d(_,{class:"timeline"},{default:n(()=>[b(v(new Date(this.year*1e3).getFullYear())+"\u5E74(12)",1)]),_:1}),s("div",E,[(l(!0),r(w,null,k(o.data,c=>(l(),h(p,{key:c.filmId,onInitdata:m.getMylove,filmid:c.filmId,loved:c.created,class:"mylove-item"},null,8,["onInitdata","filmid","loved"]))),128))])])}var T=u(N,[["render",H],["__scopeId","data-v-4e109a28"]]);export{T as default};

import"./index.56116ab8.js";import e from"./FilmsUpload.be5eedcb.js";import{d as t,i as a,a6 as l,a7 as s,a1 as o,$ as i,f as n,g as r,p as d,F as c,a8 as m,Q as p}from"./vendor.afe498d6.js";const h={data:()=>({tableData:[],currentPage:1,cloud:t.init({env:"yui-7gel1hqtaf6fb79d"}),auth:null,currentData:{},isEdit:!1,page:1,total:0}),setup:()=>({input:a("")}),created(){this.auth=this.cloud.auth({persistence:"local"}),this.getFilmsData(10);const e=this.cloud.database();e.command,e.collection("films").count().then((e=>{console.log(e.total),this.total=e.total}))},methods:{getFilmsData(e){const t=this.cloud.database();t.command,t.collection("films").orderBy("created","desc").limit(e).skip((this.page-1)*e).get().then((e=>{this.tableData=e.data}))},getFilmsDataByName(){const e=this.cloud.database();e.command;const t=new e.RegExp({regexp:this.input,options:"i"});e.collection("films").where({name:t}).get().then((e=>{this.tableData=e.data,console.log(e)}))},handleSizeChange(e){console.log(`每页 ${e} 条`),this.getFilmsData(e)},handleCurrentChange(e){console.log(`当前页: ${e}`),this.page=e},handleClick(e){this.currentData=e,this.isEdit=!0},hideModel(e){console.log(e.target.className),"edit-model"===e.target.className&&(this.isEdit=!1,this.getFilmsData())},formatter:(e,t,a,l)=>"class"===t.property&&"1"===a?"电视剧":"class"===t.property&&"2"===a?"动漫":"class"===t.property&&"3"===a?"游戏":"class"===t.property&&"4"===a?"其他":void 0,formatterTime:(e,t,a,l)=>moment(a).format("YYYY/MM/DD"),searchFilms(){this.input?this.getFilmsDataByName():this.getFilmsData(10)}},components:{"films-upload":e}},u=m("data-v-58123693");l("data-v-58123693");const g={style:{display:"flex"}},f=p("提交"),b=p("编辑"),C=p("删除"),y={class:"pageation"},D={class:"edit-model-box"};s();const x=u(((e,t,a,l,s,m)=>{const p=o("el-input"),h=o("el-button"),x=o("el-table-column"),v=o("el-table"),F=o("el-pagination"),k=o("films-upload");return i(),n(c,null,[r("div",g,[r(p,{placeholder:"请输入内容",modelValue:l.input,"onUpdate:modelValue":t[1]||(t[1]=e=>l.input=e),clearable:"",class:"film-search"},null,8,["modelValue"]),r(h,{onClick:m.searchFilms,type:"small",style:{height:"40px","margin-left":"10px"}},{default:u((()=>[f])),_:1},8,["onClick"])]),r(v,{data:s.tableData,"default-sort":{prop:"date",order:"descending"},class:"films-table"},{default:u((()=>[r(x,{prop:"name",label:"名字",sortable:""}),r(x,{prop:"class",label:"类别",sortable:"",formatter:m.formatter},null,8,["formatter"]),r(x,{prop:"link",label:"链接"}),r(x,{prop:"created",label:"创建时间",formatter:m.formatterTime},null,8,["formatter"]),r(x,{fixed:"right",label:"操作",width:"100"},{default:u((e=>[r(h,{onClick:t=>m.handleClick(e.row),type:"text",size:"small"},{default:u((()=>[b])),_:2},1032,["onClick"]),r(h,{type:"text",size:"small"},{default:u((()=>[C])),_:1})])),_:1})])),_:1},8,["data"]),r("div",y,[r(F,{onSizeChange:m.handleSizeChange,onCurrentChange:m.handleCurrentChange,"current-page":s.currentPage,"page-sizes":[10,100],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:s.total,style:{"margin-top":"20px"}},null,8,["onSizeChange","onCurrentChange","current-page","total"])]),s.isEdit?(i(),n("div",{key:0,class:"edit-model",onClick:t[2]||(t[2]=(...e)=>m.hideModel&&m.hideModel(...e))},[r("div",D,[r(k,{type:"2",filmsData:s.currentData},null,8,["filmsData"])])])):d("",!0)],64)}));h.render=x,h.__scopeId="data-v-58123693";export default h;
